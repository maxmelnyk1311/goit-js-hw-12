{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport axios from 'axios';\n\nconst form = document.querySelector(\".form\");\nconst input = document.querySelector(\".form-input\");\nconst galleryRoot = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\nconst loadingText = document.querySelector(\".loading-text\");\nlet savedQuery;\n\nloadMoreBtn.style.display = \"none\";\nloadingText.style.display = \"none\";\n\nlet ligthBoxModal = new SimpleLightbox(\".gallery a\", {\n    captionDelay: 250, \n    captionsData: \"alt\",\n});\n\nlet page = 1;\nconst limit = 40;\nlet isImagesEnded = false;\n\nasync function fetchImages() {\n    const searchParams = new URLSearchParams({\n        key: \"41748300-cb29be2b9e713bfb06ce55aab\",\n        q: \"\",\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n        per_page: limit,\n        page: page,\n    });\n\n    searchParams.set(\"q\", input.value.trim());\n    savedQuery = input.value.trim();\n\n    const response = await axios.get(`https://pixabay.com/api/?${searchParams}`);\n    let totalImages = response.data.totalHits;\n    if (totalImages === 0) {\n        return [];\n    }\n    if ((page * limit) > totalImages) {\n        isImagesEnded = true;\n        iziToast.error({\n            position: \"topRight\",\n            color: \"red\",\n            message: \"We're sorry, but you've reached the end of search results.\"\n          }); \n    }\n    return response.data.hits;\n}\n\nfunction renderImages(hits) {\n    const galleryImages = hits.reduce(\n    (html, image) =>\n        html +\n            `<li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n                    <img \n                        class=\"gallery-image\" \n                        data-source=${image.largeImageURL} \n                        src=${image.webformatURL} \n                        alt=${image.tags} \n                    />\n                </a>\n                <div class=\"gallery-item-info\">\n                    <p class=\"gallery-item-info-name\">Likes\n                        <span class=\"gallery-item-info-value\">${image.likes}\n                    </p>\n                    <p class=\"gallery-item-info-name\">Views\n                        <span class=\"gallery-item-info-value\">${image.views}</span>\n                    </p>\n                    <p class=\"gallery-item-info-name\">Comments\n                        <span class=\"gallery-item-info-value\">${image.comments}</span>\n                    </p>\n                    <p class=\"gallery-item-info-name\">Downloads\n                        <span class=\"gallery-item-info-value\">${image.downloads}</span>\n                    </p>\n                </div>\n            </li>`, '');\n    galleryRoot.insertAdjacentHTML(\"beforeend\", galleryImages);\n    ligthBoxModal.refresh();\n    ligthBoxModal.on(\"show.simplelightbox\", function () {});\n}\n\nform.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    isImagesEnded = false;\n\n    if (input.value.trim().length === 0) {\n        return;\n    }\n\n    if (savedQuery === input.value.trim()) {\n        return;\n    } else {\n        galleryRoot.innerHTML = \"\";\n        page = 1;\n    }\n\n    loadingText.style.display = \"block\";\n\n    try {\n        const images = await fetchImages();\n        renderImages(images);\n    } catch (error) {\n        iziToast.error({\n            position: \"topRight\",\n            color: \"red\",\n            message: \"Something is wrong!!!\"\n          });\n        console.log(error);\n    }\n\n    loadingText.style.display = \"none\";\n\n    if(galleryRoot.childNodes.length > 0) {    \n        page += 1;\n        loadMoreBtn.style.display = \"block\";\n    } else {\n        loadMoreBtn.style.display = \"none\";\n        iziToast.error({\n            position: \"topRight\",\n            color: \"red\",\n            message: \"Images not found!\"\n        });\n    }\n});\n\nloadMoreBtn.addEventListener(\"click\", async (event) => {\n    event.preventDefault();\n\n    loadMoreBtn.style.display = \"none\";\n    loadingText.style.display = \"block\";\n\n    try {\n        const response = await fetchImages();\n        renderImages(response);\n        page += 1;\n    } catch (error) {\n        iziToast.error({\n            position: \"topRight\",\n            color: \"red\",\n            message: \"Something is wrong!!!\"\n        });\n        console.log(error);\n    }\n    \n    loadingText.style.display = \"none\";\n    if(isImagesEnded) {\n        loadMoreBtn.style.display = \"none\";\n    } else {\n        loadMoreBtn.style.display = \"block\";\n    }\n\n    const galleryItemHeight = document.querySelector(\".gallery-item\").getBoundingClientRect().height;\n    window.scrollBy({\n        top: galleryItemHeight * 2,\n        behavior: \"smooth\",\n    });\n});\n"],"names":["form","input","galleryRoot","loadMoreBtn","loadingText","savedQuery","ligthBoxModal","SimpleLightbox","page","limit","isImagesEnded","fetchImages","searchParams","response","axios","totalImages","iziToast","renderImages","hits","galleryImages","html","image","event","images","error","galleryItemHeight"],"mappings":"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"}